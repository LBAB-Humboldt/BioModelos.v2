
function _refreshSpeciesRecordsReport(){
	$.post( "/records/edit_record", { species_id: $("#species_id_field").val()}).done(function(data) {
  			_BioModelosVisorModule.getSpeciesRecords($("#species_id_field").val(), data);
  	});
}

function getData() {
	const data = {
		recordId: "<%= params[:recordId] %>",
		reportedUserIdBm: <%= current_user.id %>
	};
	<% if params[:geoIssue] == "on" %>
		data.reportedGeoIssueBm = true;
	<% end %>
	<% if params[:idIssue] == "on" %>
		data.reportedIdIssueBm = true;
	<% end %>
	<% if params[:originVagrant] == "on" %>
		data.reportedOriginVagrant = true;
	<% end %>
	<% if params[:oldTaxonomy] == "on" %>
		data.reportedOldTaxonomyBm = true;
	<% end %>
	<% if params[:originIntroduced] == "on" %>
		data.reportedOriginIntroduced = true;
	<% end %>
	<% if params[:otherIssues] == "on" %>
		data.reportedOtherIssuesBm = true;
	<% end %>
	data.reportedCommentsBm = "<%= params[:commentsIssue] %>";
	return data;
}

$.ajax({
	type: 'POST',
	url: "/records/new_report",
	data: getData(),
	success: function(){
		_refreshSpeciesRecordsReport();
		alertify.alert("<%= t('biomodelos.records.report.success_notice') %>");
		$('.reportBox').html("");
	},
	error: function(jqXHR, textStatus, errorThrown){
		alertify.alert("<%= t('biomodelos.records.report.error_notice') %>" + errorThrown);
	}
});
